---
title: "Introducción al uso de R"
author: "Ariana Bard"
date: "`r Sys.Date()`"
lang: "es"
output:
  rmdformats::robobook:
    lightbox: TRUE
    highlight: tango
    toc: 3
    number-sections: TRUE
    code-folding: show
    code_download: TRUE
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*¡Bienvenidos al Curso de R: Análisis de Datos y Visualización!* R es un
lenguaje de programación ampliamente utilizado en la ciencia de datos,
estadísticas y análisis de datos, y a lo largo de este curso, adquirirás
las habilidades esenciales para convertirte en un experto en el manejo y
análisis de datos

Podes acceder al repositorio
[acá](https://github.com/ariibard/aprendiendoR)

# Instalación de R, RStudio y Git

### Instalación de R

Para descargar R y Rstudio, debes acceder a la página
[Posit](https://posit.co/download/rstudio-desktop/).

![](imagenes/1-instalacion.png)

Seleccionar el paso 1, que te llevara a la [página de
CRAN](https://cran.rstudio.com/) (Comprehensive R Archive Network) que
es el repositorio central de software de R. Allí, deberás seleccionar el
sistema operativo que utilices.

Luego deberás seleccionar el "install for the first time" (Instalar por
primera vez) en la parte superior de la página:

![](imagenes/1.1-instalacion.png)

### Instalación de R Studio

Una vez que lo descargas, deberás ejecutar el .exe y seguir los pasos de
la instalación. La última versión de R es la 4.2.1. En cuanto hayas
descargado R, deberás descargar RStudio que es el IDE que estaremos
usando a lo largo del curso.

Para ello vuelve a la [página de
posit](https://posit.co/download/rstudio-desktop/) y selecciona el Paso
2. También podés seleccionar la opción de descarga que mejor se adapte a
tu sistema operativo

![](imagenes/1.2-instalacion.png)

### Instalacion de Git

Para instalar git tenes que ingresar
[acá](https://git-scm.com/downloads) y seleccionar la opcion que mejor
se adapta a tu sistema operativo

![](imagenes/1.4%20Git.png)

¡Felicidades! Ahora tienes R, RStudio y Git instalados en tu compu. En
caso de tener algún inconveniente no dudes en escribirnos.

# Clase 1 - Introducción a R

En esta primera clase, exploraremos los conceptos básicos de R, un
lenguaje de programación y entorno de análisis de datos ampliamente
utilizado en la ciencia de datos y la estadística. Aprenderemos cómo
instalar R y RStudio, clonaremos un repositorio en Git y realizaremos
algunas operaciones básicas en R.

Ahora que tenemos R y RStudio instalados, podemos comenzar a explorar R.
Aquí hay algunos conceptos básicos:

## ¿Qué es R?

R es un lenguaje de programación y entorno de análisis de datos
ampliamente utilizado en la ciencia de datos, la estadística y la
investigación. Es de código abierto y ofrece una amplia variedad de
paquetes y bibliotecas que facilitan el análisis y la visualización de
datos

## Entorno de Trabajo de RStudio

Después de instalar R y RStudio, abriremos RStudio y exploraremos su
entorno de trabajo, que consta de cuatro paneles principales:

1.  **Script**: Donde podes escribir y guardar tu código R.
2.  **Console**: Donde podes ejecutar comandos de R directamente.
3.  **Environment**: Muestra las variables y objetos en tu espacio de
    trabajo.
4.  **Plots/Files/Packages/Help**: Paneles para gestionar gráficos,
    archivos, paquetes y obtener ayuda.

## Proyectos

En R, un proyecto es una estructura organizada que permite trabajar de
manera eficiente porque crea una carpeta donde se alojan todos los
archivos que vamos a utilizar en nuestro trabajo.

Para crear un proyecto en R, podes seguir estos pasos en RStudio:

1.  Abre RStudio.

2.  Ve a "File" (Archivo) en la barra de menú y selecciona "New Project"
    (Nuevo Proyecto).

3.  Elige la opción "New Directory" (Nuevo Directorio) si estás creando
    un nuevo proyecto desde cero o "Existing Directory" (Directorio
    Existente) si ya tienes un directorio existente que deseas convertir
    en un proyecto.

4.  Luego, podes especificar la ubicación del directorio y el nombre del
    proyecto.

5.  Haz clic en "Create Project" (Crear Proyecto) y se abrirá una nueva
    instancia de RStudio configurada para tu proyecto.

### ¿Cómo Clonar un Repositorio en Git?

Clonar un repositorio en Git significa copiar un repositorio remoto
(generalmente alojado en GitHub o en otro servidor) en tu computadora
local. Esto te permite trabajar en una copia local de los archivos,
realizar cambios y contribuir al proyecto.

Pasos para clonar un repositorio en Git:

1.  Ve al menú "File" (Archivo) en la parte superior izquierda de la
    ventana de RStudio.

2.  Selecciona "New Project" (Nuevo Proyecto).

3.  En el cuadro de diálogo "New Project", elige "Version Control"
    (Control de Versiones).

4.  Luego, selecciona "Git".

5.  A continuación, pega la URL del repositorio Git que deseas clonar en
    el campo "Repository URL" (URL del Repositorio). Esta URL se
    encuentra en la página del repositorio en GitHub u otra plataforma
    de alojamiento de Git.

6.  En el campo "Project directory name" (Nombre del directorio del
    proyecto), podes especificar el nombre de la carpeta local donde se
    clonará el repositorio. Por defecto, RStudio utilizará el nombre del
    repositorio.

7.  Haz clic en "Create Project" (Crear Proyecto).

## Orientación a Objetos en R

R es un lenguaje orientado a objetos, lo que significa que todo en R es
un objeto. Incluso los números, las funciones y los datos son objetos en
R.

## Crear un "Chunk" en R Markdown

Un "chunk" es un bloque de código R que podes ejecutar en un documento R
Markdown. podes insertar un chunk utilizando tres comillas invertidas y
la etiqueta `{r}` o con ctrl+alt+i . Por ejemplo:

```{r}
# Esto es un chunk de código R
x <- 5
y <- 10
z <- x + y
z
```

## Operaciones Básicas en R

A continuación, realizaremos algunas operaciones básicas en R:

### Asignación de Variables

```{r}
# Esto es un comentario en R
x <- 5 # Asignación de un valor a una variable
y <- 10

rm(y) #Para borrar los objetos del entorno
```

### Operaciones matemáticas

R es como una calculadora

```{r}
y <- 12
# Suma de variables
z <- x * y
print(paste("La suma de x y y es:", z))
```

### Vectores

En R, un vector es una estructura de datos que almacena una secuencia de
valores del mismo tipo. podes crear un vector utilizando la función
`c()`.

```{r}
# podes correr el codigo con CTRL+ENTER o con el boton
# Crear un vector
mi_vector <- c(1, 2, 3, 4, 5)

# Calcular la suma de los elementos en el vector
suma <- sum(mi_vector)

# Calcular la media
media <- mean(mi_vector)

mediana <- median(mi_vector)

#cat permite imprimir valores
cat("El resultado es", suma, "\n")
cat("Media: ", media, "\n")

# Crear un objeto puede ser con la asignacion <- o = 

Nombre <- c("Ariana","Martina")
Nombres = c("Ariana","Martina","Joaquin")

#comparacion
Nombre == Nombres
```

\## Operadores en R

R ofrece varios tipos de operadores:

-   **Asignación**: Se utiliza para asignar valores a variables. El
    operador más común es `<-` o `=`.

-   **Operadores Aritméticos**: Se utilizan para realizar operaciones
    matemáticas, como `+`, `-`, `*`, `/`, entre otros.

-   **Operadores Lógicos**: Se utilizan para evaluar condiciones
    lógicas, como `&&`, `||`, `!`.

-   **Operadores Relacionales**: Se utilizan para comparar valores, como
    `==`, `!=`, `>`, `<`.

## Tipos de Objetos en R

R tiene varios tipos de objetos, incluyendo:

-   **Numeric**: Números, por ejemplo, `3.14`.

```{r}
# Crear un objeto numeric
numero <- 3.14
class(numero)  # Verificar el tipo de objeto (numeric)
```

-   **Character**: Cadenas de texto, por ejemplo, `"Hola, R"`.

```{r}
# Crear un objeto character
texto <- "Hola, R"
class(texto)  # Verificar el tipo de objeto (character)
```

-   **Logical**: Valores lógicos, `TRUE` o `FALSE`.

```{r}
# Crear un objeto logical
verdadero <- TRUE #T
falso <- FALSE #F
class(verdadero)  # Verificar el tipo de objeto (logical)
```

-   **Integer**: Números enteros, por ejemplo, `2L`.

```{r}
# Crear un objeto integer
entero <- 2L
class(entero)  # Verificar el tipo de objeto (integer)
```

-   **Tipo Fecha**

```{r}
fecha <- as.Date("01/01/2023")
class(fecha)
```

Ahora, mostraremos cómo convertir entre estos tipos de objetos
utilizando las funciones as.numeric, as.character y as.logical:

**Conversión a Numeric**

```{r}
# Convertir character a numeric
texto <- "123.45"
class(texto)
numero <- as.numeric(texto)
class(numero)  # Verificar el tipo de objeto (numeric)
```

**Conversión a Character**

```{r}
# Convertir numeric a character
numero <- 123.45
class(numero) 
texto <- as.character(numero)
class(texto)  # Verificar el tipo de objeto (character)
```

**Conversion a logical**

```{r}
# Convertir numeric a logical
numero <- 0  # 0 se convierte en FALSE, cualquier otro número se convierte en TRUE
logico <- as.logical(numero)
class(logico)  # Verificar el tipo de objeto (logical)
```

**Conversion a factor**

```{r}
#convertir a factor

genero <- c("F","M","F","M","F","M","F","M","F","M","F","M","F","M","F","M")
class(genero)
genero <- as.factor(genero)
class(genero)
```

## Funciones en R

Lo que vimos recién, `as.factor()` y `as.character()` son funciones. Las
funciones son bloques de código reutilizables que realizan tareas
específicas. R tiene muchas funciones incorporadas y también podes crear
las tuyas propias.

#### Suma

```{r}
# Función para sumar números
suma_resultado <- sum(1, 2, 3, 4, 5)
suma_resultado
```

#### Media

```{r}
# Función para calcular la media
vector <- c(1, 2, 3, 4, 5)
media_resultado <- mean(vector)
media_resultado

print(paste("hola como estas"))
```

## Librerías en R

Las Librerías (o paquetes) en R son conjuntos de funciones y datos
adicionales que extienden las capacidades de R. Podes instalar y cargar
bibliotecas para acceder a funcionalidades adicionales.

Para instalar una biblioteca, utiliza la función
`install.packages("nombre_del_paquete")`. Para cargar una biblioteca,
utiliza `library(nombre_del_paquete)`.

```{r}
#install.packages("tidyverse")
library(tidyverse)

#%>%
```

## Práctica

1.  Crear dos `objetos` y asignarles: a uno **nombres** y a otro
    ***cuit***

```{r}
# consigna 1
empresas <- c("Cachafaz","Coca","adiddas","Pepsi","16")
empresas

cuit <- c(2,3,4,5,6,7)
cuit
```

2.  Para las dos variables creadas en el punto anterior, verificar la
    clase o el tipo de objeto:

```{r}
# consigna 2
class(empresas)
class(cuit)
```

3.  Convertir el objeto empresas en uno de tipo numérico. ¿Qué sucede?

```{r}
# consigna 3

empresas <- as.numeric(empresas)
empresas

cuit <- as.character(cuit)
cuit
```

# Clase 2

En esta segunda clase, profundizaremos en las estructuras de objetos en R, aprenderemos cómo importar y exportar datos, y exploraremos las capacidades de tidyverse para el análisis de datos.

### Estructuras de datos

En R, hay varias estructuras de objetos que permiten almacenar y manipular datos de manera eficiente:

Vector: Un vector es una secuencia de valores del mismo tipo. Son del mismo tipo que los datos que contienen
```{r}
# Objetos
Nombre <- "Ariana"

# Vectores
mi_vector <- c(1, 2, 3, 4, 5)

paises <- c("Argentina", "Brasil", "Uruguay")

numeros <- c(1,2,3)
class(numeros)
class(paises)

# Creación de una matriz
mi_matriz <- matrix(1:6, nrow = 2, ncol = 3)

# Creación de un data frame
mi_data_frame <- data.frame(
  Nombre = c("Ana", "Carlos", "Eva"),
  Edad = c(25, 30, 22)
)

# Creación de una lista
mi_lista <- list(
  Nombres = c("Ariana", "Martina"),
  Cuit = c(12345, 67890)
)
```




## Importación y exportación

### Importación

En R, puedes importar datos desde diferentes tipos de archivos, como CSV, Excel, y más. Utilizamos funciones de paquetes como read.csv, read.xlsx 

Desde una **url**:

```{r}
#Librería readr para importar archivos: 
#install.packages("readr")
library(readr)
library(readxl)

#Defino url
url <- ("https://datosabiertos.desarrollosocial.gob.ar/dataset/d45687c0-f2ba-41d9-9989-0ad9799308ae/resource/c5c925e0-7ce0-41e5-b3ff-8ebb51d4be72/download/potenciar-trabajo-titulares-2022-10-01.csv")
potenciar_trabajo <- read_csv(url)



```

*Dato*: Si no sabes o recordas los argumentos de una función, podes llamar a la función `help()` que trae la documentación de la función:

```{r}

help(read_csv)
#?read_csv

```

Desde archivo **csv**:

```{r}
potenciar_trabajo <- read_csv("data/potenciar-trabajo-titulares-activos-2022-10-01.csv")

```

También pueden descargarse desde files 

Desde archivo **.sav**:

```{r}
# install.packages("haven")
library(haven)

base <- read_sav("data/Base.sav")

```

Desde archivo **.xlsx**:

```{r}
# install.packages("readxl")
library(readxl)


precios_combustibles <-  read_excel("data/precios_res1_2018.xlsx")
 
```

### Exportación

También, puedo querer exportar los datos trabajados en R a otros formato:

A un archivo **.csv**:

```{r}
write.csv(mi_data_frame, paste0("../data/", clase, "/mi_data_frame.csv"), row.names = F, fileEncoding = "UTF-8")
```

A un archivo **.xlsx**:

```{r}
#install.packages(openxlsx)
library(openxlsx)

write.xlsx(mi_data_frame,paste0("../data/", clase, "/mi_data_frame.xlsx"), rowNames = F)
```

A un archivo **.sav**:

```{r}
#library(haven)
write_sav(mi_data_frame, paste0("../data/", clase, "/mi_data_frame.sav"))

```

Por supuesto que hay otros formatos en los que se pueden importar y exportar datos desde R. Pueden encontrar más información [aquí](https://r-coder.com/exportar-datos-r/) o [aquí](https://myrbooksp.netlify.app/import.html).

## Resumen de los datos

Antes de extraer datos, es posible explorar los distintos objetos y acceder a ellos.

Para conocer la estructura del objeto podemos usar `str()`:

```{r}
#df
str(potenciar_trabajo)

#vector
str(paises)

```

Podes acceder a los nombres de los elementos con `names()`:

```{r}

#DF
names(mi_data_frame)

#Se puede modificar el nombre de las columnas con la misma función: 

names(mi_data_frame) <- c("Nombres", "Edades")
names(registro)

#Lista
names(listado)

```

Acceder a las primeras y últimas filas con `head()`y `tail()`:

```{r}
#primeras filas
head(potenciar_trabajo)

#ultimas filas
tail(potenciar_trabajo)

```

Obtener un resumen con `summary()`:

```{r}
summary(potenciar_trabajo)
```

Y acceder a los valores únicos o distintos con `unique()`:

```{r}
unique(potenciar_trabajo$provincia)


duplicated(mi_data_frame$Nombres)
```

El `$` permite acceder a un subconjunto o elemento de un df o de una lista. También se pueden acceder a través de `[[]]`.

```{r}

unique(potenciar_trabajo[["provincia"]])

```

Por último, se pueden ver la cantidad de categorías de una variable con `lenght()` o `distinct()` (esta última pertenece a la libería Dplyr, incluida en el paquete Tidyverse que veremos más adelante).

```{r}

library(dplyr)

length(unique(potenciar_trabajo$provincia)) 
distinct(potenciar_trabajo, provincia)


```


## Tidyverse

[documentación](https://www.tidyverse.org/packages/).



```{r}
#install.packages("tidyverse")
library(tidyverse)

```

Vamos a seguir trabajando con el dataframe del potenciar trabajo. 

```{r}
#install.package("janitor")
library(janitor) #Janitor nos permite limpiar los nombres de las variables

#Importo

potenciar_trabajo_clean <-potenciar_trabajo%>% 
  clean_names() #limpiamos los nombres para no tener errores por los caracteres

```

Podemos ver las columnas como aprendimos:

```{r}
colnames(potenciar_trabajo)
#names(barrios_populares)

```

### Select()



```{r}
titulares <- potenciar_trabajo %>% 
  select(provincia, titulares, periodo)

#también podríamos acceder mediante el índice, el orden de esas columnas: 

titulares_dos <- potenciar_trabajo %>% select(7:8)

rm(titulares_dos)

gc() #limpia la memoria

#rm(list=ls())
```



## Filter()



```{r}
buenos_aires <- titulares %>% filter(provincia == "Buenos Aires")
```



```{r}

provincias_noa<-c("Jujuy", "Salta", "Tucumán", "Catamarca", "La Rioja", "Santiago del Estero")

noa <- titulares %>% filter(provincia%in%provincias_noa)
head(noa)
```

## Arrange()



```{r}
#orden ascendente
buenos_aires <- buenos_aires %>% arrange(periodo)
head(buenos_aires)


#orden descendente
buenos_aires <- buenos_aires %>% arrange(desc(periodo))
buenos_aires

```

## Mutate()



```{r}
buenos_aires <- buenos_aires %>% 
  mutate(porcentaje_por_provincia = round((titulares/sum(buenos_aires$titulares))*100,3))

#con round redondeo los números

#muestro la nueva variable
select(buenos_aires, provincia, porcentaje_por_provincia)

```

## Group_by() y summarise()



```{r}
#cantidad de filas por año
potenciar_por_ano <- buenos_aires %>% group_by(periodo) %>% summarise(barrios_creados = sum(titulares))
total_anual

#promedio 
buenos_aires_total <- buenos_aires %>% group_by(provincia) %>% summarise(total = sum(titulares))
flias

```

La función `n()` del paquere `dplyr` permite contar el número de observaciones en un grupo

## Rename()



```{r}
#nombre nuevo = nombre a cambiar

```

## Gráficos

```{r}
#esquisse::esquisser(unidades_inclusion_urbana)
```


# Práctica

